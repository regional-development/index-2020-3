Методологія
===========

Ця частина окреслює принципи побудови індексу, 
використані в поточній версії параметри, 
а також вказує на особливості збору та аналізу даних. 


Принципи
--------

* `всеохопність`: охоплює всі сфери, в яких у ОДА є реальні повноваження, визначені законом
* `гнучкість`: можна довільно змінювати перелік параметрів нижнього рівня, а також вагу параметрів у кінцевому індексі
* `нормалізованість`: всі вхідні параметри нормалізуються, що дозволяє включати до індексу будь-які показники
* `версійність`: наявні принципи визначення версій індексу, що дозволяє зберігати тяглість у оцінках
* можливість `інтеграції` зовнішніх параметрів із інших індексів

Індекс працює як конструктор, що дозволяє змінювати перелік параметрів та навіть 
способи розрахунку без шкоди загальній структурі. 

З версії `0.5` зберігаються також сирі ненормалізовані дані, що дозволить порівняти 
динаміку області за показником протягом декількох періодів. 



Параметри
---------

Структурно індекс складається з верхнього та нижнього рівнів. 

`Верхній` рівень розраховуватиметься за галузевим принципом розподілу повноважень, 
`нижній` - на основі набору параметрів для оцінки діяльності у кожній галузі, що можуть змінюватися за потреби.



Верхній рівень
^^^^^^^^^^^^^^

Параметри верхнього рівня формуються на основі таких статей `ЗУ "Про місцеві державні адміністрації"`:

* :math:`P_1`: Соціально-економічний розвиток `(Стаття 17)`
* :math:`P_2`: Бюджет та фінанси `(Стаття 18)`
* :math:`P_3`: Управління майном, приватизація, сприяння розвитку підприємництва та здійснення державної регуляторної політики `(Стаття 19)`
* :math:`P_4`: Містобудування, ЖКГ, побутове, торговельне обслуговування, транспорт і зв’язок `(Стаття 20)`
* :math:`P_5`: Використання та охорона земель, природних ресурсів і охорона довкілля `(Стаття 21)`
* :math:`P_6`: Наука, освіта, охорона здоров’я, культура, фізкультура і спорт, материнство і дитинство, сім’я та молодь `(Стаття 22)`
* :math:`P_7`: Соціальне забезпечення та соціальний захист населення `(Стаття 23)`
* :math:`P_8`: Зайнятість населення, праця та заробітна плата `(Стаття 24)`


Нижній рівень
^^^^^^^^^^^^^^

Параметри нижнього рівня є `операціоналізацією <https://en.wikipedia.org/wiki/Operationalization>`_ 
параметрів верхнього рівня. Сукупність показників нижнього рівня :math:`p2\_01-p2\_10`, наприклад, мають 
опосередковано вимірювати галузевий показник :math:`P_2`.  

Створюючи проксі-індикатори, ми в першу чергу керувалися:
    * чіткістю (для уникнення різночитань та хибних інтерпретацій під час збору даних)
    * наявністю даних 
    * точністю (проксі-показник вимірює те, що покликаний виміряти, а не інше)

Перелік показників нижнього рівня: 
Перелік усіх параметрів нижнього рівня можна знайти в цій `таблиці <https://docs.google.com/spreadsheets/d/1Pisy6EX4fkUnlm9rAqLsD_ycwWiUC9p-u3ZpKZe6oAs/edit?usp=sharing>`_



.. seealso::

    :ref:`changelog`: версійність індексу, де, зокрема, відображені зміни параметрів нижнього рівня


Як визначається вага параметрів
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
За інших рівних умов вага параметрів нижнього та верхнього рівня дорівнює `1`.

На кожному з рівнів є свій основний принцип для зміни ваги:
    * На `верхньому` рівні слід керуватися перш за все важливістю відповідного галузевого параметру у структурі повноважень ОДА 
      (наприклад, у бюджетній політиці ОДА має значно суттєвіші повноваження, ніж у сфері розвитку підприємництва, 
      тому ваги становлять відповідно `2` та `0.5`, тобто бюджетні показники впливають на остаточне значення індексу 
      в 4 рази сильніше)
    * На `нижньому` рівні найважливішою є потреба групувати показники так, щоб кілька однотипних показників не переважували 
      інші в межах окремого галузевого параметру (наприклад, вага кожного з 4 показників, що стосується виявлених 
      Держаудитслужбою порушень, становить `0.25` або `¼`) 

.. csv-table:: Вага галузевих показників верхнього рівня
   :header: "Показник", "Вага"
   :align: center

   :math:`P_1`, 2
   :math:`P_2`, 2
   :math:`P_3`, 0.5
   :math:`P_4`, 1
   :math:`P_5`, 1
   :math:`P_6`, 2
   :math:`P_7`, 1
   :math:`P_8`, 0.5

Перелік коефіцієнтів для параметрів нижнього рівня можна знайти в цій `таблиці <https://docs.google.com/spreadsheets/d/1Pisy6EX4fkUnlm9rAqLsD_ycwWiUC9p-u3ZpKZe6oAs/edit?usp=sharing>`_

Збір даних
----------

`Звідки ми беремо дані`:
    1. Публічні джерела (в пріоритеті АРІ)
    2. ОДА 
    3. Інші розпорядники


`Основні проблеми`:
    * Складно отримати актуальні дані, особливо це стосується даних у публічному доступі
    * Затримки з отриманням даних, зокрема від міністерств та ЦОВВ
    * Можливі проблеми із якістю даних, зокрема це стосується даних, що збираються вручну

.. note::
    Слід розіслати форми якомога швидше, оскільки на заповнення часто йде більше 2 тижнів. 
    Також слід запланувати час на зведення та валідацію даних, що збираються вручну 
    (як-мінімум, це 5 датасетів з кожної області).

    У цей вільний проміжок часу слід опрацювати дані з публічних джерел: 
    (openbudget, prozorro, нсзу, ВБ, міжнародно-технічна допомога, аудиторські звіти тощо)
    
Формули
-------

У цій секції окреслені формулу для розрахунку індексу 

Нормалізація
^^^^^^^^^^^^

`Min-max normalization` означає перетворення набору значень до певної шкали за такою формулою:

.. math::

    {x}' = a + \frac{(x-min(x))(b-a)}{max(x)-min(x)}

де 

- :math:`x` - набір значень
- :math:`a` та :math:`b` - межі шкали нормалізації 

Для розрахунку індексу використовується декілька способів такої нормалізації.

Способи нормалізації
""""""""""""""""""""

0. Нормалізація `не потрібна` у тих випадках, коли показник сам по собі визначений у межах [0;1]
1. `Відносна` нормалізація: межі визначаються, як максимальний та мінімальний показник серед регіонів
2. `Нормативна` нормалізація: межі задаються на основі цільових показників
3. `Змішана` нормалізація: одна з меж задається за відносним принципом, інша - за нормативним

`Зворотна` нормалізація використовується для будь-яких способів нормалізації у випадках, 
коли вище емпіричне значення означає нижче значення нормалізованого показника 
(як у випадку з рівнем безробіття чи кількістю нещасних випадків) 

У чинній версії індексу переважно використовується відносна нормалізація, проте 
потрібно докладати зусиль для того, щоб більше показників можна було нормалізувати 
на основі цільових показників, визначеними конкретними документами -- наприклад, 
Державною стратегією регіонального розвитку.

.. csv-table:: Способи нормалізації (для нормативної шкала [500, 5000], для змішаної - [мін, 5000]
   :header: "Область", "Обсяг видатків", "Відносна", "Обернена", "Нормативна", "Змішана"

   "Львівська", 2141.394, 1.0, 0.0, 0.365, 0.384
   "Закарпатська", 739.349, 0.213, 0.787, 0.053, 0.082
   "Волинська", 728.099, 0.207, 0.793, 0.051, 0.079
   "Херсонська", 542.0, 0.102, 0.898, 0.009, 0.039
   "Чернівецька", 360.268, 0.0, 1.0, -0.031, 0.0


Середнє зважене
^^^^^^^^^^^^^^^

Кожен галузевий параметр рахується як середнє зважене відповідних параметрів нижнього рівня. 
У свою чергу, індекс оцінки є середнім зваженим галузевих параметрів.


.. math::

    \bar{x} = \frac{\sum_{i=1}^{n} w_ix_i}{\sum_{i=1}^{n} w_i}

де :math:`x` є значенням, :math:`w` - його вагою


Параметр нижнього рівня
"""""""""""""""""""""""

.. .. image:: ../images/f1.png
..     :width: 400 px
..     :alt: Формула розрахунку галузевих параметрів (нижній рівень індексу) 
..     :align: center

.. math::

    P_i = \frac{\sum_{j=1}^{m} k_{ij}p_{ij}}{\sum_{j=1}^{m} k_{ij}} \times 10 

де: 

- :math:`P_i` - галузевий параметр
- :math:`p_{ij}` - нормалізований на проміжку [0;1] параметр нижнього рівня (докладніше про принципами нормалізації нижче)
- :math:`k_{ij}` - коефіцієнт важливості (за замовчанням дорівнює 1)
- :math:`m` - кількість параметрів нижнього рівня, що використовуються для розрахунку галузевого параметру

Параметр верхнього рівня
""""""""""""""""""""""""

.. .. image:: ../images/f2.png
..     :width: 400 px
..     :alt: Формула розрахунку індексу оцінки 
..     :align: center

.. math::

    I = \left [  \frac{\sum_{i=1}^{n} K_iP_i}{\sum_{i=1}^{n} K_i} \times 10 \right ]

де: 

- :math:`I`  - індекс оцінки діяльності ОДА
- :math:`P_i` - галузевий параметр
- :math:`K_i` - коефіцієнт важливості (за замовчанням дорівнює 1)
- :math:`n` - кількість галузевих параметрів (наразі, згідно із ЗУ "Про місцеві державні адміністрації", їх 8)

.. seealso::

    :ref:`sourcecode`: Вихідний код з втіленням формул в ``Python``

